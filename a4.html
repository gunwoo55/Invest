<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê²Œì„ - FINE U</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .game-card:hover {
            transform: translateY(-2px);
            transition: transform 0.3s ease;
        }
        .rocket {
            transition: transform 0.5s ease;
        }
        .rocket.flying {
            transform: translateY(-100px);
        }
        .dodoori {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #FFE135, #FFA500);
            border-radius: 50%;
            position: relative;
            animation: bounce 2s infinite;
        }
        .dodoori::before {
            content: 'ğŸ£';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 40px;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .progress-bar {
            background: linear-gradient(90deg, #3B82F6, #10B981);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen pb-20">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center">
                <button onclick="history.back()" class="mr-4">
                    <i class="fas fa-arrow-left text-xl"></i>
                </button>
                <h1 class="text-xl font-bold">ê²Œì„</h1>
            </div>
        </div>
    </header>

    <!-- User Game Stats -->
    <div id="gameStatsSection" class="hidden bg-white border-b p-4">
        <div class="grid grid-cols-3 gap-4 text-center">
            <div>
                <p class="text-sm text-gray-600">ê²Œì„ ì ìˆ˜</p>
                <p class="text-lg font-bold text-blue-600" id="totalGamePoints">0</p>
            </div>
            <div>
                <p class="text-sm text-gray-600">í€´ì¦ˆ ì •ë‹µë¥ </p>
                <p class="text-lg font-bold text-green-600" id="quizAccuracy">0%</p>
            </div>
            <div>
                <p class="text-sm text-gray-600">ë˜‘ë¶€ë¦¬ ë ˆë²¨</p>
                <p class="text-lg font-bold text-purple-600" id="dodooriLevel">1</p>
            </div>
        </div>
    </div>

    <!-- Tab Navigation -->
    <div class="bg-white border-b">
        <div class="container mx-auto px-4">
            <div class="flex">
                <button id="quizTab" class="px-6 py-3 text-blue-600 border-b-2 border-blue-600 font-medium">
                    ê²½ì œ í€´ì¦ˆ
                </button>
                <button id="rocketTab" class="px-6 py-3 text-gray-600 hover:text-blue-600 font-medium">
                    ë¡œì¼“ê²Œì„
                </button>
                <button id="dodooriTab" class="px-6 py-3 text-gray-600 hover:text-blue-600 font-medium">
                    ë˜‘ë¶€ë¦¬ í‚¤ìš°ê¸°
                </button>
            </div>
        </div>
    </div>

    <!-- Content -->
    <main class="container mx-auto px-4 py-6">
        <!-- Quiz Section -->
        <div id="quizSection">
            <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                <h2 class="text-lg font-bold mb-4 flex items-center">
                    <i class="fas fa-brain text-purple-500 mr-2"></i>
                    ê²½ì œ í€´ì¦ˆ ê²Œì„
                </h2>
                <p class="text-gray-600 mb-4">ê²½ì œ ì§€ì‹ì„ í…ŒìŠ¤íŠ¸í•˜ê³  ì ìˆ˜ë¥¼ íšë“í•˜ì„¸ìš”!</p>
                
                <!-- Quiz Stats -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="text-center p-4 bg-blue-50 rounded-lg">
                        <p class="text-sm text-gray-600">ì˜¤ëŠ˜ í’€ì€ ë¬¸ì œ</p>
                        <p class="text-2xl font-bold text-blue-600" id="todayQuizCount">0</p>
                    </div>
                    <div class="text-center p-4 bg-green-50 rounded-lg">
                        <p class="text-sm text-gray-600">íšë“ ì ìˆ˜</p>
                        <p class="text-2xl font-bold text-green-600" id="quizPoints">0</p>
                    </div>
                </div>

                <!-- Quiz Game Area -->
                <div id="quizGameArea">
                    <div id="quizStart" class="text-center">
                        <button onclick="startQuiz()" class="bg-blue-600 text-white px-8 py-3 rounded-lg text-lg font-medium hover:bg-blue-700 transition">
                            í€´ì¦ˆ ì‹œì‘í•˜ê¸°
                        </button>
                    </div>

                    <div id="quizActive" class="hidden">
                        <div class="mb-4">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm text-gray-600">ë¬¸ì œ <span id="currentQuestion">1</span> / 5</span>
                                <span class="text-sm text-gray-600">ë‚¨ì€ ì‹œê°„: <span id="timeRemaining">30</span>ì´ˆ</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div id="quizProgress" class="progress-bar h-2 rounded-full" style="width: 20%"></div>
                            </div>
                        </div>

                        <div class="bg-gray-50 p-4 rounded-lg mb-4">
                            <h3 class="text-lg font-bold mb-4" id="questionText"></h3>
                            <div class="space-y-2" id="answerOptions">
                                <!-- Answer options will be populated by JavaScript -->
                            </div>
                        </div>

                        <div class="text-center">
                            <button id="nextQuestion" onclick="nextQuestion()" class="hidden bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition">
                                ë‹¤ìŒ ë¬¸ì œ
                            </button>
                        </div>
                    </div>

                    <div id="quizResults" class="hidden text-center">
                        <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg p-6 mb-4">
                            <h3 class="text-xl font-bold mb-2">í€´ì¦ˆ ì™„ë£Œ!</h3>
                            <p class="text-lg">ì ìˆ˜: <span id="finalScore">0</span> / 100</p>
                            <p class="text-sm opacity-90">ì •ë‹µë¥ : <span id="finalAccuracy">0</span>%</p>
                        </div>
                        <button onclick="resetQuiz()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
                            ë‹¤ì‹œ ë„ì „í•˜ê¸°
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Rocket Game Section -->
        <div id="rocketSection" class="hidden">
            <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                <h2 class="text-lg font-bold mb-4 flex items-center">
                    <i class="fas fa-rocket text-orange-500 mr-2"></i>
                    ë¡œì¼“ê²Œì„ - íˆ¬ì íƒ€ì´ë°
                </h2>
                <p class="text-gray-600 mb-4">ë¡œì¼“ì´ í­ë°œí•˜ê¸° ì „ì— ì ì ˆí•œ íƒ€ì´ë°ì— íŒë§¤í•˜ì„¸ìš”!</p>

                <!-- Rocket Game Stats -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="text-center p-4 bg-orange-50 rounded-lg">
                        <p class="text-sm text-gray-600">ìµœê³  ê¸°ë¡</p>
                        <p class="text-2xl font-bold text-orange-600" id="rocketBestScore">0x</p>
                    </div>
                    <div class="text-center p-4 bg-red-50 rounded-lg">
                        <p class="text-sm text-gray-600">ì´ ìˆ˜ìµ</p>
                        <p class="text-2xl font-bold text-red-600" id="rocketTotalEarnings">0</p>
                    </div>
                </div>

                <!-- Rocket Game Area -->
                <div id="rocketGameArea">
                    <div id="rocketStart" class="text-center">
                        <div class="mb-4">
                            <div class="rocket text-6xl">ğŸš€</div>
                        </div>
                        <button onclick="startRocketGame()" class="bg-orange-600 text-white px-8 py-3 rounded-lg text-lg font-medium hover:bg-orange-700 transition">
                            ê²Œì„ ì‹œì‘
                        </button>
                    </div>

                    <div id="rocketActive" class="hidden text-center">
                        <div class="mb-6">
                            <div class="rocket text-8xl mb-4" id="rocketIcon">ğŸš€</div>
                            <div class="text-3xl font-bold text-green-600 mb-2" id="rocketMultiplier">1.00x</div>
                            <div class="text-sm text-gray-600">í˜„ì¬ ìˆ˜ìµë¥ </div>
                        </div>
                        
                        <div class="mb-4">
                            <div class="text-lg font-bold text-blue-600 mb-2">íˆ¬ìê¸ˆ: <span id="rocketInvestment">10,000</span>ì›</div>
                            <div class="text-lg font-bold text-green-600">ì˜ˆìƒ ìˆ˜ìµ: <span id="rocketEarnings">10,000</span>ì›</div>
                        </div>

                        <button id="cashOutBtn" onclick="cashOut()" class="bg-red-600 text-white px-8 py-3 rounded-lg text-lg font-medium hover:bg-red-700 transition">
                            í˜„ê¸ˆí™”í•˜ê¸°
                        </button>
                    </div>

                    <div id="rocketResult" class="hidden text-center">
                        <div class="mb-4" id="rocketResultIcon">ğŸ’¥</div>
                        <div class="text-xl font-bold mb-2" id="rocketResultText">ë¡œì¼“ì´ í­ë°œí–ˆìŠµë‹ˆë‹¤!</div>
                        <div class="text-lg mb-4" id="rocketResultEarnings">ìˆ˜ìµ: 0ì›</div>
                        <button onclick="resetRocketGame()" class="bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700 transition">
                            ë‹¤ì‹œ ê²Œì„í•˜ê¸°
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dodoori Game Section -->
        <div id="dodooriSection" class="hidden">
            <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                <h2 class="text-lg font-bold mb-4 flex items-center">
                    <i class="fas fa-egg text-yellow-500 mr-2"></i>
                    ë˜‘ë¶€ë¦¬ í‚¤ìš°ê¸°
                </h2>
                <p class="text-gray-600 mb-4">íˆ¬ì ìˆ˜ìµìœ¼ë¡œ ë˜‘ë¶€ë¦¬ë¥¼ í‚¤ìš°ê³  ì„±ì¥ì‹œí‚¤ì„¸ìš”!</p>

                <!-- Dodoori Display -->
                <div class="text-center mb-6">
                    <div class="dodoori mx-auto mb-4"></div>
                    <h3 class="text-lg font-bold" id="dodooriName">ë˜‘ë¶€ë¦¬</h3>
                    <p class="text-gray-600" id="dodooriAge">íƒœì–´ë‚œ ì§€ 1ì¼</p>
                </div>

                <!-- Dodoori Stats -->
                <div class="space-y-4 mb-6">
                    <div>
                        <div class="flex justify-between mb-1">
                            <span class="text-sm text-gray-600">ë ˆë²¨</span>
                            <span class="text-sm font-medium" id="dodooriLevelText">1</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="dodooriLevelProgress" class="bg-yellow-500 h-2 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div>
                        <div class="flex justify-between mb-1">
                            <span class="text-sm text-gray-600">í–‰ë³µë„</span>
                            <span class="text-sm font-medium" id="dodooriHappiness">100%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="dodooriHappinessBar" class="bg-green-500 h-2 rounded-full" style="width: 100%"></div>
                        </div>
                    </div>
                    
                    <div>
                        <div class="flex justify-between mb-1">
                            <span class="text-sm text-gray-600">ë°°ê³ í””</span>
                            <span class="text-sm font-medium" id="dodooriHunger">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="dodooriHungerBar" class="bg-red-500 h-2 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <!-- Dodoori Actions -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <button onclick="feedDodoori()" class="bg-green-500 text-white p-4 rounded-lg hover:bg-green-600 transition">
                        <i class="fas fa-utensils text-2xl mb-2"></i>
                        <p class="font-medium">ë¨¹ì´ì£¼ê¸°</p>
                        <p class="text-sm opacity-90">1,000ì›</p>
                    </button>
                    <button onclick="playWithDodoori()" class="bg-blue-500 text-white p-4 rounded-lg hover:bg-blue-600 transition">
                        <i class="fas fa-gamepad text-2xl mb-2"></i>
                        <p class="font-medium">ë†€ì•„ì£¼ê¸°</p>
                        <p class="text-sm opacity-90">500ì›</p>
                    </button>
                    <button onclick="upgradeDodoori()" class="bg-purple-500 text-white p-4 rounded-lg hover:bg-purple-600 transition">
                        <i class="fas fa-star text-2xl mb-2"></i>
                        <p class="font-medium">ë ˆë²¨ì—…</p>
                        <p class="text-sm opacity-90" id="upgradePrice">5,000ì›</p>
                    </button>
                    <button onclick="earnMoney()" class="bg-yellow-500 text-white p-4 rounded-lg hover:bg-yellow-600 transition">
                        <i class="fas fa-coins text-2xl mb-2"></i>
                        <p class="font-medium">ì¼í•˜ê¸°</p>
                        <p class="text-sm opacity-90">ìˆ˜ìµ íšë“</p>
                    </button>
                </div>

                <!-- Dodoori Achievements -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <h3 class="font-bold mb-3">ì—…ì </h3>
                    <div class="grid grid-cols-2 gap-2 text-sm" id="achievementsList">
                        <!-- Achievements will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200">
        <div class="grid grid-cols-5 h-16">
            <a href="index.html" class="flex flex-col items-center justify-center text-gray-600 hover:text-blue-600">
                <i class="fas fa-home text-xl"></i>
                <span class="text-xs mt-1">í™ˆ</span>
            </a>
            <a href="a1.html" class="flex flex-col items-center justify-center text-gray-600 hover:text-blue-600">
                <i class="fas fa-chart-line text-xl"></i>
                <span class="text-xs mt-1">íˆ¬ì</span>
            </a>
            <a href="a2.html" class="flex flex-col items-center justify-center text-gray-600 hover:text-blue-600">
                <i class="fas fa-newspaper text-xl"></i>
                <span class="text-xs mt-1">ë‰´ìŠ¤</span>
            </a>
            <a href="a4.html" class="flex flex-col items-center justify-center text-blue-600">
                <i class="fas fa-gamepad text-xl"></i>
                <span class="text-xs mt-1">ê²Œì„</span>
            </a>
            <a href="a3.html" class="flex flex-col items-center justify-center text-gray-600 hover:text-blue-600">
                <i class="fas fa-bars text-xl"></i>
                <span class="text-xs mt-1">ë”ë³´ê¸°</span>
            </a>
        </div>
    </nav>

    <script>
        // User data
        let userData = JSON.parse(localStorage.getItem('fineUserData')) || null;
        let gameData = JSON.parse(localStorage.getItem('fineGameData')) || {
            quizStats: { correct: 0, total: 0, todayCount: 0, points: 0 },
            rocketStats: { bestScore: 0, totalEarnings: 0 },
            dodoori: { level: 1, exp: 0, happiness: 100, hunger: 0, lastFed: Date.now(), birthDate: Date.now() }
        };

        // Quiz data
        const quizQuestions = [
            {
                question: "ì¸í”Œë ˆì´ì…˜ì´ë€ ë¬´ì—‡ì¸ê°€ìš”?",
                options: ["ë¬¼ê°€ê°€ ì§€ì†ì ìœ¼ë¡œ ìƒìŠ¹í•˜ëŠ” í˜„ìƒ", "ë¬¼ê°€ê°€ ì§€ì†ì ìœ¼ë¡œ í•˜ë½í•˜ëŠ” í˜„ìƒ", "í™˜ìœ¨ì´ ìƒìŠ¹í•˜ëŠ” í˜„ìƒ", "ê¸ˆë¦¬ê°€ ì¸ìƒë˜ëŠ” í˜„ìƒ"],
                correct: 0
            },
            {
                question: "PER(ì£¼ê°€ìˆ˜ìµë¹„ìœ¨)ì´ ë†’ë‹¤ëŠ” ê²ƒì€ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ë‚˜ìš”?",
                options: ["ì£¼ì‹ì´ ì €í‰ê°€ë˜ì–´ ìˆë‹¤", "ì£¼ì‹ì´ ê³ í‰ê°€ë˜ì–´ ìˆì„ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤", "ë°°ë‹¹ê¸ˆì´ ë§ë‹¤", "íšŒì‚¬ì˜ ë§¤ì¶œì´ ë†’ë‹¤"],
                correct: 1
            },
            {
                question: "ë¶„ì‚°íˆ¬ìì˜ ëª©ì ì€ ë¬´ì—‡ì¸ê°€ìš”?",
                options: ["ìˆ˜ìµë¥ ì„ ê·¹ëŒ€í™”í•˜ê¸° ìœ„í•´", "ë¦¬ìŠ¤í¬ë¥¼ ì¤„ì´ê¸° ìœ„í•´", "ê±°ë˜ ìˆ˜ìˆ˜ë£Œë¥¼ ì¤„ì´ê¸° ìœ„í•´", "ì„¸ê¸ˆì„ ì ˆì•½í•˜ê¸° ìœ„í•´"],
                correct: 1
            },
            {
                question: "ì¤‘ì•™ì€í–‰ì´ ê¸°ì¤€ê¸ˆë¦¬ë¥¼ ì¸ìƒí•˜ë©´ ì¼ë°˜ì ìœ¼ë¡œ ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚˜ë‚˜ìš”?",
                options: ["ì£¼ì‹ì‹œì¥ì´ ìƒìŠ¹í•œë‹¤", "ë¶€ë™ì‚° ê°€ê²©ì´ ìƒìŠ¹í•œë‹¤", "ì˜ˆê¸ˆê¸ˆë¦¬ê°€ ìƒìŠ¹í•œë‹¤", "í™˜ìœ¨ì´ í•˜ë½í•œë‹¤"],
                correct: 2
            },
            {
                question: "ETF(ìƒì¥ì§€ìˆ˜í€ë“œ)ì˜ íŠ¹ì§•ì´ ì•„ë‹Œ ê²ƒì€?",
                options: ["ì£¼ì‹ì²˜ëŸ¼ ê±°ë˜ì†Œì—ì„œ ê±°ë˜ëœë‹¤", "ë¶„ì‚°íˆ¬ì íš¨ê³¼ê°€ ìˆë‹¤", "ìš´ìš©ë³´ìˆ˜ê°€ ì¼ë°˜ í€ë“œë³´ë‹¤ ë‚®ë‹¤", "ì›ê¸ˆì´ ë³´ì¥ëœë‹¤"],
                correct: 3
            }
        ];

        let currentQuizIndex = 0;
        let quizScore = 0;
        let quizTimer = null;
        let timeLeft = 30;
        let selectedAnswer = -1;

        // Rocket game variables
        let rocketMultiplier = 1.0;
        let rocketInterval = null;
        let rocketInvestment = 10000;
        let rocketActive = false;

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            if (userData) {
                showGameStats();
                updateDodooriStats();
            }
            setupTabs();
            loadGameData();
        });

        // Setup tabs
        function setupTabs() {
            const tabs = ['quizTab', 'rocketTab', 'dodooriTab'];
            const sections = ['quizSection', 'rocketSection', 'dodooriSection'];

            tabs.forEach((tabId, index) => {
                document.getElementById(tabId).addEventListener('click', () => {
                    tabs.forEach(t => {
                        const tab = document.getElementById(t);
                        tab.className = 'px-6 py-3 text-gray-600 hover:text-blue-600 font-medium';
                    });
                    sections.forEach(s => {
                        document.getElementById(s).classList.add('hidden');
                    });

                    document.getElementById(tabId).className = 'px-6 py-3 text-blue-600 border-b-2 border-blue-600 font-medium';
                    document.getElementById(sections[index]).classList.remove('hidden');
                });
            });
        }

        // Show game stats
        function showGameStats() {
            document.getElementById('gameStatsSection').classList.remove('hidden');
            const totalPoints = gameData.quizStats.points + gameData.rocketStats.totalEarnings;
            const accuracy = gameData.quizStats.total > 0 ? Math.round((gameData.quizStats.correct / gameData.quizStats.total) * 100) : 0;
            
            document.getElementById('totalGamePoints').textContent = totalPoints;
            document.getElementById('quizAccuracy').textContent = `${accuracy}%`;
            document.getElementById('dodooriLevel').textContent = gameData.dodoori.level;
        }

        // Load game data
        function loadGameData() {
            document.getElementById('todayQuizCount').textContent = gameData.quizStats.todayCount;
            document.getElementById('quizPoints').textContent = gameData.quizStats.points;
            document.getElementById('rocketBestScore').textContent = `${gameData.rocketStats.bestScore.toFixed(2)}x`;
            document.getElementById('rocketTotalEarnings').textContent = formatCurrency(gameData.rocketStats.totalEarnings);
        }

        // Quiz functions
        function startQuiz() {
            currentQuizIndex = 0;
            quizScore = 0;
            document.getElementById('quizStart').classList.add('hidden');
            document.getElementById('quizActive').classList.remove('hidden');
            showQuestion();
        }

        function showQuestion() {
            const question = quizQuestions[currentQuizIndex];
            document.getElementById('currentQuestion').textContent = currentQuizIndex + 1;
            document.getElementById('questionText').textContent = question.question;
            
            const optionsContainer = document.getElementById('answerOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'w-full text-left p-3 bg-white border border-gray-300 rounded-lg hover:bg-blue-50 transition';
                button.textContent = option;
                button.onclick = () => selectAnswer(index);
                optionsContainer.appendChild(button);
            });

            updateQuizProgress();
            startTimer();
        }

        function selectAnswer(index) {
            selectedAnswer = index;
            const buttons = document.querySelectorAll('#answerOptions button');
            const question = quizQuestions[currentQuizIndex];
            
            buttons.forEach((btn, i) => {
                btn.disabled = true;
                if (i === question.correct) {
                    btn.className += ' bg-green-100 border-green-500 text-green-700';
                } else if (i === index && i !== question.correct) {
                    btn.className += ' bg-red-100 border-red-500 text-red-700';
                }
            });

            if (index === question.correct) {
                quizScore += 20;
            }

            clearInterval(quizTimer);
            document.getElementById('nextQuestion').classList.remove('hidden');
        }

        function nextQuestion() {
            currentQuizIndex++;
            selectedAnswer = -1;
            document.getElementById('nextQuestion').classList.add('hidden');
            
            if (currentQuizIndex < quizQuestions.length) {
                showQuestion();
            } else {
                endQuiz();
            }
        }

        function startTimer() {
            timeLeft = 30;
            document.getElementById('timeRemaining').textContent = timeLeft;
            
            quizTimer = setInterval(() => {
                timeLeft--;
                document.getElementById('timeRemaining').textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(quizTimer);
                    if (selectedAnswer === -1) {
                        selectAnswer(-1); // No answer selected
                    }
                }
            }, 1000);
        }

        function updateQuizProgress() {
            const progress = ((currentQuizIndex + 1) / quizQuestions.length) * 100;
            document.getElementById('quizProgress').style.width = `${progress}%`;
        }

        function endQuiz() {
            document.getElementById('quizActive').classList.add('hidden');
            document.getElementById('quizResults').classList.remove('hidden');
            
            const accuracy = Math.round((quizScore / 100) * 100);
            document.getElementById('finalScore').textContent = quizScore;
            document.getElementById('finalAccuracy').textContent = accuracy;
            
            // Update game data
            gameData.quizStats.correct += Math.round(quizScore / 20);
            gameData.quizStats.total += quizQuestions.length;
            gameData.quizStats.todayCount += quizQuestions.length;
            gameData.quizStats.points += quizScore;
            
            // Add points to user cash
            if (userData) {
                userData.cash += quizScore * 100; // 100ì› per point
                localStorage.setItem('fineUserData', JSON.stringify(userData));
            }
            
            saveGameData();
            loadGameData();
            showGameStats();
        }

        function resetQuiz() {
            document.getElementById('quizResults').classList.add('hidden');
            document.getElementById('quizStart').classList.remove('hidden');
        }

        // Rocket game functions
        function startRocketGame() {
            rocketMultiplier = 1.0;
            rocketActive = true;
            document.getElementById('rocketStart').classList.add('hidden');
            document.getElementById('rocketActive').classList.remove('hidden');
            
            updateRocketDisplay();
            
            rocketInterval = setInterval(() => {
                if (Math.random() < 0.02) { // 2% chance to crash each interval
                    crashRocket();
                } else {
                    rocketMultiplier += 0.01 + (Math.random() * 0.02);
                    updateRocketDisplay();
                }
            }, 100);
        }

        function updateRocketDisplay() {
            const multiplier = rocketMultiplier.toFixed(2);
            const earnings = Math.round(rocketInvestment * rocketMultiplier);
            
            document.getElementById('rocketMultiplier').textContent = `${multiplier}x`;
            document.getElementById('rocketInvestment').textContent = rocketInvestment.toLocaleString();
            document.getElementById('rocketEarnings').textContent = earnings.toLocaleString();
            
            // Animate rocket based on multiplier
            const rocket = document.getElementById('rocketIcon');
            if (rocketMultiplier > 2) {
                rocket.classList.add('flying');
            }
        }

        function cashOut() {
            if (!rocketActive) return;
            
            clearInterval(rocketInterval);
            rocketActive = false;
            
            const earnings = Math.round(rocketInvestment * (rocketMultiplier - 1));
            
            document.getElementById('rocketActive').classList.add('hidden');
            document.getElementById('rocketResult').classList.remove('hidden');
            
            document.getElementById('rocketResultIcon').textContent = 'ğŸ’°';
            document.getElementById('rocketResultText').textContent = 'ì„±ê³µì ìœ¼ë¡œ í˜„ê¸ˆí™”í–ˆìŠµë‹ˆë‹¤!';
            document.getElementById('rocketResultEarnings').textContent = `ìˆ˜ìµ: ${formatCurrency(earnings)}`;
            
            // Update stats
            if (rocketMultiplier > gameData.rocketStats.bestScore) {
                gameData.rocketStats.bestScore = rocketMultiplier;
            }
            gameData.rocketStats.totalEarnings += earnings;
            
            // Add earnings to user cash
            if (userData) {
                userData.cash += earnings;
                localStorage.setItem('fineUserData', JSON.stringify(userData));
            }
            
            saveGameData();
            loadGameData();
            showGameStats();
        }

        function crashRocket() {
            clearInterval(rocketInterval);
            rocketActive = false;
            
            document.getElementById('rocketActive').classList.add('hidden');
            document.getElementById('rocketResult').classList.remove('hidden');
            
            document.getElementById('rocketResultIcon').textContent = 'ğŸ’¥';
            document.getElementById('rocketResultText').textContent = 'ë¡œì¼“ì´ í­ë°œí–ˆìŠµë‹ˆë‹¤!';
            document.getElementById('rocketResultEarnings').textContent = 'ìˆ˜ìµ: 0ì›';
        }

        function resetRocketGame() {
            document.getElementById('rocketResult').classList.add('hidden');
            document.getElementById('rocketStart').classList.remove('hidden');
            document.getElementById('rocketIcon').classList.remove('flying');
        }

        // Dodoori functions
        function updateDodooriStats() {
            const dodoori = gameData.dodoori;
            const now = Date.now();
            const daysSinceBirth = Math.floor((now - dodoori.birthDate) / (1000 * 60 * 60 * 24)) + 1;
            
            // Decrease happiness and increase hunger over time
            const hoursSinceLastFed = (now - dodoori.lastFed) / (1000 * 60 * 60);
            dodoori.hunger = Math.min(100, Math.floor(hoursSinceLastFed * 5));
            dodoori.happiness = Math.max(0, 100 - Math.floor(hoursSinceLastFed * 2));
            
            document.getElementById('dodooriAge').textContent = `íƒœì–´ë‚œ ì§€ ${daysSinceBirth}ì¼`;
            document.getElementById('dodooriLevelText').textContent = dodoori.level;
            document.getElementById('dodooriHappiness').textContent = `${dodoori.happiness}%`;
            document.getElementById('dodooriHunger').textContent = `${dodoori.hunger}%`;
            
            document.getElementById('dodooriLevelProgress').style.width = `${(dodoori.exp % 100)}%`;
            document.getElementById('dodooriHappinessBar').style.width = `${dodoori.happiness}%`;
            document.getElementById('dodooriHungerBar').style.width = `${dodoori.hunger}%`;
            
            const upgradePrice = dodoori.level * 5000;
            document.getElementById('upgradePrice').textContent = `${formatCurrency(upgradePrice)}`;
            
            updateAchievements();
        }

        function feedDodoori() {
            if (!userData || userData.cash < 1000) {
                alert('ë¨¹ì´ë¥¼ ì‚´ ëˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤!');
                return;
            }
            
            userData.cash -= 1000;
            gameData.dodoori.hunger = Math.max(0, gameData.dodoori.hunger - 30);
            gameData.dodoori.happiness = Math.min(100, gameData.dodoori.happiness + 10);
            gameData.dodoori.lastFed = Date.now();
            gameData.dodoori.exp += 5;
            
            checkLevelUp();
            saveData();
            updateDodooriStats();
        }

        function playWithDodoori() {
            if (!userData || userData.cash < 500) {
                alert('ë†€ì´ìš©í’ˆì„ ì‚´ ëˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤!');
                return;
            }
            
            userData.cash -= 500;
            gameData.dodoori.happiness = Math.min(100, gameData.dodoori.happiness + 15);
            gameData.dodoori.exp += 3;
            
            checkLevelUp();
            saveData();
            updateDodooriStats();
        }

        function upgradeDodoori() {
            const upgradePrice = gameData.dodoori.level * 5000;
            
            if (!userData || userData.cash < upgradePrice) {
                alert('ë ˆë²¨ì—… ë¹„ìš©ì´ ë¶€ì¡±í•©ë‹ˆë‹¤!');
                return;
            }
            
            userData.cash -= upgradePrice;
            gameData.dodoori.level++;
            gameData.dodoori.exp = 0;
            
            saveData();
            updateDodooriStats();
            alert(`ë˜‘ë¶€ë¦¬ê°€ ë ˆë²¨ ${gameData.dodoori.level}ë¡œ ì„±ì¥í–ˆìŠµë‹ˆë‹¤!`);
        }

        function earnMoney() {
            const earnings = gameData.dodoori.level * 1000 + Math.floor(Math.random() * 500);
            
            if (userData) {
                userData.cash += earnings;
                gameData.dodoori.exp += 2;
                
                checkLevelUp();
                saveData();
                updateDodooriStats();
                alert(`ë˜‘ë¶€ë¦¬ê°€ ${formatCurrency(earnings)}ë¥¼ ë²Œì—ˆìŠµë‹ˆë‹¤!`);
            }
        }

        function checkLevelUp() {
            if (gameData.dodoori.exp >= 100) {
                gameData.dodoori.level++;
                gameData.dodoori.exp = 0;
                alert(`ë˜‘ë¶€ë¦¬ê°€ ë ˆë²¨ ${gameData.dodoori.level}ë¡œ ì„±ì¥í–ˆìŠµë‹ˆë‹¤!`);
            }
        }

        function updateAchievements() {
            const achievements = [
                { name: 'ì²« ë¨¹ì´', condition: gameData.dodoori.exp > 0 },
                { name: 'ë ˆë²¨ 5 ë‹¬ì„±', condition: gameData.dodoori.level >= 5 },
                { name: 'í–‰ë³µí•œ ë˜‘ë¶€ë¦¬', condition: gameData.dodoori.happiness >= 90 },
                { name: 'í€´ì¦ˆ ë§ˆìŠ¤í„°', condition: gameData.quizStats.correct >= 20 }
            ];
            
            const achievementsList = document.getElementById('achievementsList');
            achievementsList.innerHTML = '';
            
            achievements.forEach(achievement => {
                const div = document.createElement('div');
                div.className = `p-2 rounded-lg text-center ${achievement.condition ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-500'}`;
                div.innerHTML = `
                    <i class="fas fa-${achievement.condition ? 'trophy' : 'lock'} mb-1"></i>
                    <p class="text-xs">${achievement.name}</p>
                `;
                achievementsList.appendChild(div);
            });
        }

        // Utility functions
        function saveGameData() {
            localStorage.setItem('fineGameData', JSON.stringify(gameData));
        }

        function saveData() {
            localStorage.setItem('fineUserData', JSON.stringify(userData));
            saveGameData();
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('ko-KR', {
                style: 'currency',
                currency: 'KRW'
            }).format(amount);
        }

        // Auto-update dodoori stats every minute
        setInterval(updateDodooriStats, 60000);
    </script>
</body>
</html>