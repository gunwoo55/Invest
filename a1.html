<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í¬íŠ¸í´ë¦¬ì˜¤ - FINE U</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <header class="header">
            <h1>ğŸ“Š í¬íŠ¸í´ë¦¬ì˜¤</h1>
            <p class="subtitle">ë‚´ íˆ¬ì í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p>
            <div class="profile-icon" onclick="goToProfile()">
                <img id="headerProfileImg" style="display: none;" alt="í”„ë¡œí•„">
                <span class="default-icon" id="headerDefaultIcon">ğŸ‘¤</span>
            </div>
        </header>

        <div class="content">
            <!-- ì´ ìì‚° í˜„í™© -->
            <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <h3>ğŸ’° ì´ ìì‚°</h3>
                <div style="font-size: 32px; font-weight: 600; margin: 15px 0;" id="totalAssets">â‚©0</div>
                <div style="display: flex; justify-content: space-between;">
                    <div>
                        <div style="font-size: 14px; opacity: 0.9;">íˆ¬ìê¸ˆì•¡</div>
                        <div style="font-size: 18px; font-weight: 500;" id="investedAmount">â‚©0</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 14px; opacity: 0.9;">ìˆ˜ìµë¥ </div>
                        <div style="font-size: 18px; font-weight: 500;" id="returnRate">+0.00%</div>
                    </div>
                </div>
            </div>

            <!-- ìì‚° ë¶„ë°° ì°¨íŠ¸ -->
            <div class="card">
                <h3>ğŸ“ˆ ìì‚° ë¶„ë°°</h3>
                <div id="assetChart" style="margin: 20px 0;">
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <div style="font-size: 48px; margin-bottom: 10px;">ğŸ“Š</div>
                        <div>íˆ¬ì í›„ ì°¨íŠ¸ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>
                    </div>
                </div>
            </div>

            <!-- ë³´ìœ  ì¢…ëª© -->
            <div class="card">
                <h3>ğŸ’¼ ë³´ìœ  ì¢…ëª©</h3>
                <div id="portfolioList">
                    <!-- í¬íŠ¸í´ë¦¬ì˜¤ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- íˆ¬ì íˆìŠ¤í† ë¦¬ -->
            <div class="card">
                <h3>ğŸ“‹ íˆ¬ì íˆìŠ¤í† ë¦¬</h3>
                <div id="investmentHistory">
                    <!-- íˆ¬ì íˆìŠ¤í† ë¦¬ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
        <nav class="nav-menu">
            <a href="index.html" class="nav-item">
                <span class="nav-icon">ğŸ </span>
                í™ˆ
            </a>
            <a href="a1.html" class="nav-item active">
                <span class="nav-icon">ğŸ“Š</span>
                í¬íŠ¸í´ë¦¬ì˜¤
            </a>
            <a href="a2.html" class="nav-item">
                <span class="nav-icon">ğŸ“°</span>
                ë‰´ìŠ¤
            </a>
            <a href="a3.html" class="nav-item">
                <span class="nav-icon">ğŸ“š</span>
                í•™ìŠµ
            </a>
            <a href="a4.html" class="nav-item">
                <span class="nav-icon">ğŸ’³</span>
                ê°€ê³„ë¶€
            </a>
            <a href="a5.html" class="nav-item">
                <span class="nav-icon">ğŸ’°</span>
                íˆ¬ì
            </a>
        </nav>
    </div>

    <script>
        // í¬íŠ¸í´ë¦¬ì˜¤ ë°ì´í„° ë¡œë“œ
        function loadPortfolio() {
            const portfolio = JSON.parse(localStorage.getItem('portfolio')) || [];
            const balance = parseFloat(localStorage.getItem('balance')) || 10000000;
            
            let totalInvested = 0;
            let currentValue = 0;
            
            portfolio.forEach(item => {
                totalInvested += item.totalInvested;
                currentValue += item.quantity * item.currentPrice;
            });
            
            const totalAssets = currentValue + balance;
            const returnRate = totalInvested > 0 ? ((currentValue - totalInvested) / totalInvested * 100) : 0;
            
            // UI ì—…ë°ì´íŠ¸
            document.getElementById('totalAssets').textContent = 'â‚©' + totalAssets.toLocaleString();
            document.getElementById('investedAmount').textContent = 'â‚©' + totalInvested.toLocaleString();
            
            const returnElement = document.getElementById('returnRate');
            returnElement.textContent = (returnRate >= 0 ? '+' : '') + returnRate.toFixed(2) + '%';
            returnElement.style.color = returnRate >= 0 ? '#4CAF50' : '#F44336';
            
            // í¬íŠ¸í´ë¦¬ì˜¤ ëª©ë¡ ë Œë”ë§
            renderPortfolioList(portfolio);
            renderAssetChart(portfolio, balance);
        }

        // í¬íŠ¸í´ë¦¬ì˜¤ ëª©ë¡ ë Œë”ë§
        function renderPortfolioList(portfolio) {
            const container = document.getElementById('portfolioList');
            
            if (portfolio.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">ë³´ìœ  ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            container.innerHTML = '';
            
            portfolio.forEach(item => {
                const currentValue = item.quantity * item.currentPrice;
                const profitLoss = currentValue - item.totalInvested;
                const profitRate = (profitLoss / item.totalInvested * 100);
                
                const listItem = document.createElement('div');
                listItem.className = 'investment-item';
                listItem.style.marginBottom = '12px';
                listItem.style.border = '1px solid #eee';
                listItem.style.borderRadius = '8px';
                listItem.style.padding = '16px';
                
                listItem.innerHTML = `
                    <div class="investment-info">
                        <div class="investment-name">${item.name}</div>
                        <div class="investment-price">ë³´ìœ : ${item.quantity.toLocaleString()}${item.category === 'savings' ? 'ì›' : 'ì£¼'}</div>
                    </div>
                    <div class="investment-change ${profitLoss >= 0 ? 'positive' : 'negative'}">
                        <div>â‚©${currentValue.toLocaleString()}</div>
                        <div style="font-size: 12px;">${profitLoss >= 0 ? '+' : ''}â‚©${Math.abs(profitLoss).toLocaleString()}</div>
                    </div>
                `;
                
                container.appendChild(listItem);
            });
        }

        // ìì‚° ë¶„ë°° ì°¨íŠ¸ ë Œë”ë§ (ê°„ë‹¨í•œ ë²„ì „)
        function renderAssetChart(portfolio, balance) {
            const container = document.getElementById('assetChart');
            
            if (portfolio.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <div style="font-size: 48px; margin-bottom: 10px;">ğŸ“Š</div>
                        <div>íˆ¬ì í›„ ì°¨íŠ¸ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>
                    </div>
                `;
                return;
            }
            
            // ì¹´í…Œê³ ë¦¬ë³„ ìì‚° ì§‘ê³„
            const categoryTotals = {};
            let totalInvested = 0;
            
            portfolio.forEach(item => {
                const value = item.quantity * item.currentPrice;
                totalInvested += value;
                
                if (!categoryTotals[item.category]) {
                    categoryTotals[item.category] = 0;
                }
                categoryTotals[item.category] += value;
            });
            
            const categoryNames = {
                stocks: 'ì£¼ì‹',
                crypto: 'ì•”í˜¸í™”í',
                bonds: 'ì±„ê¶Œ',
                etf: 'ETF',
                savings: 'ì˜ˆì ê¸ˆ',
                commodities: 'ê·€ê¸ˆì†'
            };
            
            const colors = {
                stocks: '#FF6B6B',
                crypto: '#4ECDC4',
                bonds: '#45B7D1',
                etf: '#96CEB4',
                savings: '#FFEAA7',
                commodities: '#DDA0DD'
            };
            
            let chartHTML = '';
            Object.keys(categoryTotals).forEach(category => {
                const percentage = (categoryTotals[category] / totalInvested * 100).toFixed(1);
                chartHTML += `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin: 8px 0;">
                        <div style="display: flex; align-items: center;">
                            <div style="width: 12px; height: 12px; background: ${colors[category]}; border-radius: 50%; margin-right: 8px;"></div>
                            <span>${categoryNames[category]}</span>
                        </div>
                        <div>
                            <span style="font-weight: 600;">â‚©${categoryTotals[category].toLocaleString()}</span>
                            <span style="color: #666; margin-left: 8px;">(${percentage}%)</span>
                        </div>
                    </div>
                `;
            });
            
            // í˜„ê¸ˆ ë¹„ì¤‘ ì¶”ê°€
            const totalAssets = totalInvested + balance;
            const cashPercentage = (balance / totalAssets * 100).toFixed(1);
            chartHTML += `
                <div style="display: flex; justify-content: space-between; align-items: center; margin: 8px 0;">
                    <div style="display: flex; align-items: center;">
                        <div style="width: 12px; height: 12px; background: #BDC3C7; border-radius: 50%; margin-right: 8px;"></div>
                        <span>í˜„ê¸ˆ</span>
                    </div>
                    <div>
                        <span style="font-weight: 600;">â‚©${balance.toLocaleString()}</span>
                        <span style="color: #666; margin-left: 8px;">(${cashPercentage}%)</span>
                    </div>
                </div>
            `;
            
            container.innerHTML = chartHTML;
        }

        // í”„ë¡œí•„ë¡œ ì´ë™
        function goToProfile() {
            window.location.href = 'index.html';
        }

        // í”„ë¡œí•„ ì´ë¯¸ì§€ ë¡œë“œ
        function loadProfileImage() {
            const savedImage = localStorage.getItem('profileImage');
            if (savedImage) {
                const headerProfileImg = document.getElementById('headerProfileImg');
                const headerDefaultIcon = document.getElementById('headerDefaultIcon');
                
                if (headerProfileImg && headerDefaultIcon) {
                    headerProfileImg.src = savedImage;
                    headerProfileImg.style.display = 'block';
                    headerDefaultIcon.style.display = 'none';
                }
            }
        }

        // í˜ì´ì§€ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            loadProfileImage();
            loadPortfolio();
        });
    </script>
</body>
</html>