<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>투자 - FINE U</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .price-up { color: #EF4444; }
        .price-down { color: #3B82F6; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen pb-20">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center">
                <button onclick="history.back()" class="mr-4">
                    <i class="fas fa-arrow-left text-xl"></i>
                </button>
                <h1 class="text-xl font-bold">투자하기</h1>
            </div>
        </div>
    </header>

    <!-- User Info Banner -->
    <div id="userBanner" class="bg-white border-b p-4">
        <div class="flex justify-between items-center">
            <div>
                <p class="text-sm text-gray-600">보유 현금</p>
                <p class="text-lg font-bold text-green-600" id="availableCash"></p>
            </div>
            <div class="text-right">
                <p class="text-sm text-gray-600">투자 등급</p>
                <p class="text-lg font-bold text-blue-600" id="investmentGrade"></p>
            </div>
        </div>
    </div>

    <!-- Investment Categories -->
    <main class="container mx-auto px-4 py-6">
        <!-- Stocks Section -->
        <div class="mb-6">
            <div class="bg-white rounded-lg card-shadow p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-bold flex items-center">
                        <i class="fas fa-chart-line text-green-500 mr-2"></i>
                        주식
                    </h2>
                    <span class="text-sm text-gray-500">실시간 시세</span>
                </div>
                <div class="space-y-3" id="stockList">
                    <!-- Stock items will be populated by JavaScript -->
                </div>
                <button class="w-full mt-4 bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition">
                    더 많은 주식 보기
                </button>
            </div>
        </div>

        <!-- Cryptocurrency Section -->
        <div class="mb-6">
            <div class="bg-white rounded-lg card-shadow p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-bold flex items-center">
                        <i class="fab fa-bitcoin text-yellow-500 mr-2"></i>
                        암호화폐
                    </h2>
                    <span class="text-sm text-gray-500">실시간 시세</span>
                </div>
                <div class="space-y-3" id="cryptoList">
                    <!-- Crypto items will be populated by JavaScript -->
                </div>
                <button class="w-full mt-4 bg-yellow-500 text-white py-2 rounded-lg hover:bg-yellow-600 transition">
                    더 많은 암호화폐 보기
                </button>
            </div>
        </div>

        <!-- Bonds Section -->
        <div class="mb-6">
            <div class="bg-white rounded-lg card-shadow p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-bold flex items-center">
                        <i class="fas fa-university text-purple-500 mr-2"></i>
                        채권
                    </h2>
                    <span class="text-sm text-gray-500">안전한 투자</span>
                </div>
                <div class="space-y-3">
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="font-medium">국고채 3년</p>
                            <p class="text-sm text-gray-600">연 3.2% 수익률</p>
                        </div>
                        <button onclick="investInAsset('bond', '국고채 3년', 3.2)" class="bg-purple-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-purple-600 transition">
                            투자하기
                        </button>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="font-medium">회사채 5년</p>
                            <p class="text-sm text-gray-600">연 4.1% 수익률</p>
                        </div>
                        <button onclick="investInAsset('bond', '회사채 5년', 4.1)" class="bg-purple-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-purple-600 transition">
                            투자하기
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Savings Section -->
        <div class="mb-6">
            <div class="bg-white rounded-lg card-shadow p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-bold flex items-center">
                        <i class="fas fa-piggy-bank text-pink-500 mr-2"></i>
                        예적금
                    </h2>
                    <span class="text-sm text-gray-500">원금보장</span>
                </div>
                <div class="space-y-3">
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="font-medium">정기예금 1년</p>
                            <p class="text-sm text-gray-600">연 2.5% 수익률</p>
                        </div>
                        <button onclick="investInAsset('savings', '정기예금 1년', 2.5)" class="bg-pink-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-pink-600 transition">
                            투자하기
                        </button>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="font-medium">적금 2년</p>
                            <p class="text-sm text-gray-600">연 2.8% 수익률</p>
                        </div>
                        <button onclick="investInAsset('savings', '적금 2년', 2.8)" class="bg-pink-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-pink-600 transition">
                            투자하기
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ETF Section -->
        <div class="mb-6">
            <div class="bg-white rounded-lg card-shadow p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-bold flex items-center">
                        <i class="fas fa-chart-pie text-indigo-500 mr-2"></i>
                        ETF
                    </h2>
                    <span class="text-sm text-gray-500" id="etfGradeInfo">실버 등급 이상 투자 가능</span>
                </div>
                <div class="space-y-3" id="etfSection">
                    <div class="text-center p-8 text-gray-500" id="etfLocked">
                        <i class="fas fa-lock text-4xl mb-2"></i>
                        <p>실버 등급 이상에서 투자 가능합니다</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Precious Metals Section -->
        <div class="mb-6">
            <div class="bg-white rounded-lg card-shadow p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-bold flex items-center">
                        <i class="fas fa-gem text-yellow-600 mr-2"></i>
                        귀금속
                    </h2>
                    <span class="text-sm text-gray-500" id="metalsGradeInfo">골드 등급 이상 투자 가능</span>
                </div>
                <div class="space-y-3" id="metalsSection">
                    <div class="text-center p-8 text-gray-500" id="metalsLocked">
                        <i class="fas fa-lock text-4xl mb-2"></i>
                        <p>골드 등급 이상에서 투자 가능합니다</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Investment Modal -->
    <div id="investmentModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
            <h2 class="text-xl font-bold mb-4" id="modalTitle">투자하기</h2>
            <div class="mb-4">
                <p class="text-gray-600 mb-2" id="modalDescription"></p>
                <p class="text-lg font-bold" id="modalPrice"></p>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2">투자 금액</label>
                <input type="number" id="investmentAmount" min="10000" step="10000" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500" placeholder="최소 1만원">
            </div>
            <div class="flex space-x-4">
                <button id="confirmInvestment" class="flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition">
                    투자하기
                </button>
                <button id="cancelInvestment" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition">
                    취소
                </button>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200">
        <div class="grid grid-cols-5 h-16">
            <a href="index.html" class="flex flex-col items-center justify-center text-gray-600 hover:text-blue-600">
                <i class="fas fa-home text-xl"></i>
                <span class="text-xs mt-1">홈</span>
            </a>
            <a href="a1.html" class="flex flex-col items-center justify-center text-blue-600">
                <i class="fas fa-chart-line text-xl"></i>
                <span class="text-xs mt-1">투자</span>
            </a>
            <a href="a2.html" class="flex flex-col items-center justify-center text-gray-600 hover:text-blue-600">
                <i class="fas fa-newspaper text-xl"></i>
                <span class="text-xs mt-1">뉴스</span>
            </a>
            <a href="a4.html" class="flex flex-col items-center justify-center text-gray-600 hover:text-blue-600">
                <i class="fas fa-gamepad text-xl"></i>
                <span class="text-xs mt-1">게임</span>
            </a>
            <a href="a3.html" class="flex flex-col items-center justify-center text-gray-600 hover:text-blue-600">
                <i class="fas fa-bars text-xl"></i>
                <span class="text-xs mt-1">더보기</span>
            </a>
        </div>
    </nav>

    <script>
        // User data
        let userData = JSON.parse(localStorage.getItem('fineUserData')) || null;
        let currentInvestment = null;

        // Mock stock data
        const stockData = [
            { symbol: 'AAPL', name: '애플', price: 150000, change: 2.5 },
            { symbol: 'GOOGL', name: '구글', price: 2500000, change: -1.2 },
            { symbol: 'TSLA', name: '테슬라', price: 800000, change: 5.8 },
            { symbol: 'AMZN', name: '아마존', price: 3200000, change: 1.3 },
            { symbol: 'NFLX', name: '넷플릭스', price: 400000, change: -0.7 }
        ];

        // Mock cryptocurrency data
        const cryptoData = [
            { symbol: 'BTC', name: '비트코인', price: 65000000, change: 3.2 },
            { symbol: 'ETH', name: '이더리움', price: 4500000, change: 2.8 },
            { symbol: 'BNB', name: '바이낸스코인', price: 350000, change: -1.5 },
            { symbol: 'ADA', name: '카르다노', price: 1200, change: 4.1 },
            { symbol: 'SOL', name: '솔라나', price: 180000, change: 6.7 }
        ];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            if (!userData) {
                alert('로그인이 필요합니다.');
                location.href = 'index.html';
                return;
            }
            
            updateUserInfo();
            loadStockData();
            loadCryptoData();
            updateGradeAccess();
        });

        // Update user information
        function updateUserInfo() {
            document.getElementById('availableCash').textContent = formatCurrency(userData.cash);
            
            const totalAssets = userData.cash + userData.stocks + userData.crypto + userData.bonds + userData.etf + userData.savings + userData.preciousMetals;
            let grade = '브론즈';
            if (totalAssets >= 100000000) grade = '다이아몬드';
            else if (totalAssets >= 50000000) grade = '플래티넘';
            else if (totalAssets >= 20000000) grade = '골드';
            else if (totalAssets >= 10000000) grade = '실버';
            
            document.getElementById('investmentGrade').textContent = grade;
        }

        // Load stock data
        function loadStockData() {
            const stockList = document.getElementById('stockList');
            stockList.innerHTML = '';
            
            stockData.forEach(stock => {
                const stockItem = createAssetItem(stock, 'stock');
                stockList.appendChild(stockItem);
            });
        }

        // Load cryptocurrency data
        function loadCryptoData() {
            const cryptoList = document.getElementById('cryptoList');
            cryptoList.innerHTML = '';
            
            cryptoData.forEach(crypto => {
                const cryptoItem = createAssetItem(crypto, 'crypto');
                cryptoList.appendChild(cryptoItem);
            });
        }

        // Create asset item
        function createAssetItem(asset, type) {
            const div = document.createElement('div');
            div.className = 'flex justify-between items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition cursor-pointer';
            
            const changeClass = asset.change >= 0 ? 'price-up' : 'price-down';
            const changeIcon = asset.change >= 0 ? '▲' : '▼';
            
            div.innerHTML = `
                <div>
                    <p class="font-medium">${asset.name}</p>
                    <p class="text-sm text-gray-600">${asset.symbol}</p>
                </div>
                <div class="text-right">
                    <p class="font-bold">${formatCurrency(asset.price)}</p>
                    <p class="text-sm ${changeClass}">${changeIcon} ${Math.abs(asset.change)}%</p>
                </div>
            `;
            
            div.addEventListener('click', () => {
                openInvestmentModal(asset, type);
            });
            
            return div;
        }

        // Update grade-based access
        function updateGradeAccess() {
            const totalAssets = userData.cash + userData.stocks + userData.crypto + userData.bonds + userData.etf + userData.savings + userData.preciousMetals;
            
            // ETF access (Silver grade and above)
            if (totalAssets >= 10000000) {
                document.getElementById('etfLocked').style.display = 'none';
                document.getElementById('etfGradeInfo').textContent = '분산투자 상품';
                loadETFData();
            }
            
            // Precious metals access (Gold grade and above)
            if (totalAssets >= 20000000) {
                document.getElementById('metalsLocked').style.display = 'none';
                document.getElementById('metalsGradeInfo').textContent = '안전자산';
                loadMetalsData();
            }
        }

        // Load ETF data
        function loadETFData() {
            const etfSection = document.getElementById('etfSection');
            etfSection.innerHTML = `
                <div class="space-y-3">
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="font-medium">KODEX 200</p>
                            <p class="text-sm text-gray-600">코스피 200 추종</p>
                        </div>
                        <button onclick="investInAsset('etf', 'KODEX 200', 0)" class="bg-indigo-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-indigo-600 transition">
                            투자하기
                        </button>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="font-medium">TIGER 미국나스닥100</p>
                            <p class="text-sm text-gray-600">나스닥 100 추종</p>
                        </div>
                        <button onclick="investInAsset('etf', 'TIGER 미국나스닥100', 0)" class="bg-indigo-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-indigo-600 transition">
                            투자하기
                        </button>
                    </div>
                </div>
            `;
        }

        // Load precious metals data
        function loadMetalsData() {
            const metalsSection = document.getElementById('metalsSection');
            metalsSection.innerHTML = `
                <div class="space-y-3">
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="font-medium">금 1g</p>
                            <p class="text-sm text-gray-600">현재가: 80,000원</p>
                        </div>
                        <button onclick="investInAsset('metals', '금 1g', 0)" class="bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-yellow-700 transition">
                            투자하기
                        </button>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="font-medium">은 1g</p>
                            <p class="text-sm text-gray-600">현재가: 1,200원</p>
                        </div>
                        <button onclick="investInAsset('metals', '은 1g', 0)" class="bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-yellow-700 transition">
                            투자하기
                        </button>
                    </div>
                </div>
            `;
        }

        // Open investment modal
        function openInvestmentModal(asset, type) {
            currentInvestment = { asset, type };
            document.getElementById('modalTitle').textContent = `${asset.name} 투자하기`;
            document.getElementById('modalDescription').textContent = asset.symbol || asset.name;
            document.getElementById('modalPrice').textContent = `현재가: ${formatCurrency(asset.price || 0)}`;
            document.getElementById('investmentModal').classList.remove('hidden');
        }

        // Invest in asset
        function investInAsset(type, name, rate) {
            const asset = { name, price: 0, rate };
            openInvestmentModal(asset, type);
        }

        // Confirm investment
        document.getElementById('confirmInvestment').addEventListener('click', function() {
            const amount = parseInt(document.getElementById('investmentAmount').value);
            
            if (!amount || amount < 10000) {
                alert('최소 투자 금액은 1만원입니다.');
                return;
            }
            
            if (amount > userData.cash) {
                alert('보유 현금이 부족합니다.');
                return;
            }
            
            // Update user data
            userData.cash -= amount;
            
            switch (currentInvestment.type) {
                case 'stock':
                    userData.stocks += amount;
                    break;
                case 'crypto':
                    userData.crypto += amount;
                    break;
                case 'bond':
                    userData.bonds += amount;
                    break;
                case 'savings':
                    userData.savings += amount;
                    break;
                case 'etf':
                    userData.etf += amount;
                    break;
                case 'metals':
                    userData.preciousMetals += amount;
                    break;
            }
            
            // Add transaction record
            userData.transactions.push({
                type: currentInvestment.type,
                asset: currentInvestment.asset.name,
                amount: amount,
                date: new Date().toISOString(),
                action: 'buy'
            });
            
            localStorage.setItem('fineUserData', JSON.stringify(userData));
            
            alert(`${formatCurrency(amount)}를 ${currentInvestment.asset.name}에 투자했습니다.`);
            
            document.getElementById('investmentModal').classList.add('hidden');
            document.getElementById('investmentAmount').value = '';
            updateUserInfo();
        });

        // Cancel investment
        document.getElementById('cancelInvestment').addEventListener('click', function() {
            document.getElementById('investmentModal').classList.add('hidden');
            document.getElementById('investmentAmount').value = '';
        });

        // Format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('ko-KR', {
                style: 'currency',
                currency: 'KRW'
            }).format(amount);
        }

        // Simulate real-time price updates
        setInterval(() => {
            stockData.forEach(stock => {
                const change = (Math.random() - 0.5) * 2; // -1% to 1%
                stock.change = change;
                stock.price = Math.round(stock.price * (1 + change / 100));
            });
            
            cryptoData.forEach(crypto => {
                const change = (Math.random() - 0.5) * 4; // -2% to 2%
                crypto.change = change;
                crypto.price = Math.round(crypto.price * (1 + change / 100));
            });
            
            loadStockData();
            loadCryptoData();
        }, 5000); // Update every 5 seconds
    </script>
</body>
</html>