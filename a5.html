<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íˆ¬ì - FINE U</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .balance-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .balance-amount {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .balance-label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .product-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .product-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #eee;
        }
        
        .product-card:hover {
            transform: translateY(-2px);
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }
        
        .product-card.active {
            border-color: #667eea;
            background: #f8f9ff;
        }
        
        .product-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }
        
        .product-name {
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }
        
        .product-list {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .list-header {
            background: #f8f9fa;
            padding: 12px 16px;
            font-weight: 600;
            color: #333;
            border-bottom: 1px solid #eee;
        }
        
        .product-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .product-item:last-child {
            border-bottom: none;
        }
        
        .product-item:hover {
            background: #f8f9fa;
        }
        
        .item-info {
            flex: 1;
        }
        
        .item-name {
            font-weight: 600;
            margin-bottom: 4px;
            color: #333;
        }
        
        .item-code {
            font-size: 12px;
            color: #666;
        }
        
        .item-price {
            text-align: right;
        }
        
        .current-price {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 2px;
        }
        
        .price-change {
            font-size: 12px;
            font-weight: 500;
        }
        
        .price-change.positive {
            color: #dc3545;
        }
        
        .price-change.negative {
            color: #0d6efd;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 12px;
            padding: 20px;
            width: 90%;
            max-width: 400px;
        }
        
        .modal-header {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .modal-body {
            margin-bottom: 20px;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
        }
        
        .modal-buttons button {
            flex: 1;
        }
        
        .input-group {
            margin-bottom: 16px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .portfolio-summary {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .summary-item:last-child {
            margin-bottom: 0;
            border-top: 1px solid #eee;
            padding-top: 8px;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <header class="header">
            <h1>ğŸ’° íˆ¬ì</h1>
            <p class="subtitle">ëª¨ì˜íˆ¬ìë¡œ ê²½í—˜ì„ ìŒ“ì•„ë³´ì„¸ìš”</p>
            <div class="profile-icon" onclick="goToProfile()">
                <img id="headerProfileImg" style="display: none;" alt="í”„ë¡œí•„">
                <span class="default-icon" id="headerDefaultIcon">ğŸ‘¤</span>
            </div>
        </header>

        <div class="content">
            <!-- ì”ê³  ì •ë³´ -->
            <div class="balance-card">
                <div class="balance-amount" id="balance">â‚©10,000,000</div>
                <div class="balance-label">íˆ¬ì ê°€ëŠ¥ ê¸ˆì•¡</div>
            </div>

            <!-- ë‚´ í¬íŠ¸í´ë¦¬ì˜¤ ìš”ì•½ -->
            <div class="portfolio-summary">
                <h3>ğŸ“Š ë‚´ í¬íŠ¸í´ë¦¬ì˜¤</h3>
                <div class="summary-item">
                    <span>ì´ íˆ¬ìê¸ˆì•¡</span>
                    <span id="totalInvested">â‚©0</span>
                </div>
                <div class="summary-item">
                    <span>í˜„ì¬ í‰ê°€ê¸ˆì•¡</span>
                    <span id="currentValue">â‚©0</span>
                </div>
                <div class="summary-item">
                    <span>ìˆ˜ìµ/ì†ì‹¤</span>
                    <span id="profitLoss">â‚©0 (0.00%)</span>
                </div>
            </div>

            <!-- íˆ¬ì ìƒí’ˆ ì¹´í…Œê³ ë¦¬ -->
            <div class="product-grid">
                <div class="product-card active" onclick="selectCategory('stocks')">
                    <div class="product-icon">ğŸ“ˆ</div>
                    <div class="product-name">ì£¼ì‹</div>
                </div>
                <div class="product-card" onclick="selectCategory('crypto')">
                    <div class="product-icon">â‚¿</div>
                    <div class="product-name">ì•”í˜¸í™”í</div>
                </div>
                <div class="product-card" onclick="selectCategory('bonds')">
                    <div class="product-icon">ğŸ“œ</div>
                    <div class="product-name">ì±„ê¶Œ</div>
                </div>
                <div class="product-card" onclick="selectCategory('etf')">
                    <div class="product-icon">ğŸ“Š</div>
                    <div class="product-name">ETF</div>
                </div>
                <div class="product-card" onclick="selectCategory('savings')">
                    <div class="product-icon">ğŸ¦</div>
                    <div class="product-name">ì˜ˆì ê¸ˆ</div>
                </div>
                <div class="product-card" onclick="selectCategory('commodities')">
                    <div class="product-icon">ğŸ¥‡</div>
                    <div class="product-name">ê·€ê¸ˆì†</div>
                </div>
            </div>

            <!-- íˆ¬ì ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ -->
            <div class="product-list">
                <div class="list-header" id="listHeader">ğŸ“ˆ ì£¼ì‹</div>
                <div id="productContainer">
                    <!-- ìƒí’ˆ ëª©ë¡ì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        <!-- íˆ¬ì ëª¨ë‹¬ -->
        <div id="investModal" class="modal">
            <div class="modal-content">
                <div class="modal-header" id="modalTitle">íˆ¬ìí•˜ê¸°</div>
                <div class="modal-body">
                    <div class="input-group">
                        <label>íˆ¬ì ê¸ˆì•¡</label>
                        <input type="number" id="investAmount" placeholder="íˆ¬ìí•  ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="input-group">
                        <label>ìˆ˜ëŸ‰</label>
                        <input type="number" id="investQuantity" placeholder="ìˆ˜ëŸ‰ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div style="font-size: 14px; color: #666; text-align: center;">
                        ì˜ˆìƒ ì´ íˆ¬ìê¸ˆì•¡: <span id="expectedTotal">â‚©0</span>
                    </div>
                </div>
                <div class="modal-buttons">
                    <button class="btn btn-secondary" onclick="closeModal()">ì·¨ì†Œ</button>
                    <button class="btn" onclick="executeInvestment()">íˆ¬ìí•˜ê¸°</button>
                </div>
            </div>
        </div>

        <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
        <nav class="nav-menu">
            <a href="index.html" class="nav-item">
                <span class="nav-icon">ğŸ </span>
                í™ˆ
            </a>
            <a href="a1.html" class="nav-item">
                <span class="nav-icon">ğŸ“Š</span>
                í¬íŠ¸í´ë¦¬ì˜¤
            </a>
            <a href="a2.html" class="nav-item">
                <span class="nav-icon">ğŸ“°</span>
                ë‰´ìŠ¤
            </a>
            <a href="a3.html" class="nav-item">
                <span class="nav-icon">ğŸ“š</span>
                í•™ìŠµ
            </a>
            <a href="a4.html" class="nav-item">
                <span class="nav-icon">ğŸ’³</span>
                ê°€ê³„ë¶€
            </a>
            <a href="a5.html" class="nav-item active">
                <span class="nav-icon">ğŸ’°</span>
                íˆ¬ì
            </a>
        </nav>
    </div>

    <script>
        let currentCategory = 'stocks';
        let selectedProduct = null;
        let priceUpdateInterval = null;

        // íˆ¬ì API ì„œë¹„ìŠ¤ (ì‹¤ì œ API ì—°ë™ì„ ìœ„í•œ êµ¬ì¡°)
        const InvestmentAPI = {
            // ì£¼ì‹ ë°ì´í„° (Yahoo Finance API ì—°ë™)
            async getStocks() {
                // ì‹¤ì œ êµ¬í˜„ ì‹œ Yahoo Finance API ì‚¬ìš©
                const mockStocks = [
                    { name: 'ì‚¼ì„±ì „ì', code: '005930', price: 75000, change: 1.2, volume: 1234567 },
                    { name: 'SKí•˜ì´ë‹‰ìŠ¤', code: '000660', price: 130000, change: -0.8, volume: 987654 },
                    { name: 'NAVER', code: '035420', price: 195000, change: 2.1, volume: 567890 },
                    { name: 'LGì—ë„ˆì§€ì†”ë£¨ì…˜', code: '373220', price: 520000, change: -1.5, volume: 345678 },
                    { name: 'ì¹´ì¹´ì˜¤', code: '035720', price: 85000, change: 0.7, volume: 789012 }
                ];
                
                // ê°€ê²© ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì‹œê°„ ë³€ë™)
                return mockStocks.map(stock => ({
                    ...stock,
                    price: Math.round(stock.price * (1 + (Math.random() - 0.5) * 0.02)),
                    change: Number(((Math.random() - 0.5) * 4).toFixed(2))
                }));
            },

            // ì•”í˜¸í™”í ë°ì´í„° (CoinGecko API ì—°ë™)
            async getCrypto() {
                const mockCrypto = [
                    { name: 'ë¹„íŠ¸ì½”ì¸', code: 'BTC', price: 45000000, change: -0.8 },
                    { name: 'ì´ë”ë¦¬ì›€', code: 'ETH', price: 3200000, change: 1.5 },
                    { name: 'ë¦¬í”Œ', code: 'XRP', price: 650, change: -2.1 },
                    { name: 'ì—ì´ë‹¤', code: 'ADA', price: 520, change: 0.9 },
                    { name: 'í´ì¹´ë‹·', code: 'DOT', price: 8200, change: 1.8 }
                ];
                
                return mockCrypto.map(crypto => ({
                    ...crypto,
                    price: Math.round(crypto.price * (1 + (Math.random() - 0.5) * 0.05)),
                    change: Number(((Math.random() - 0.5) * 6).toFixed(2))
                }));
            },

            // ì±„ê¶Œ ë°ì´í„°
            async getBonds() {
                return [
                    { name: 'êµ­ê³ ì±„ 3ë…„', code: 'KTB3Y', price: 3.2, change: 0.1, unit: '%' },
                    { name: 'êµ­ê³ ì±„ 5ë…„', code: 'KTB5Y', price: 3.5, change: -0.05, unit: '%' },
                    { name: 'êµ­ê³ ì±„ 10ë…„', code: 'KTB10Y', price: 3.8, change: 0.15, unit: '%' },
                    { name: 'íšŒì‚¬ì±„ AA-', code: 'CORP_AA', price: 4.2, change: 0.08, unit: '%' }
                ];
            },

            // ETF ë°ì´í„°
            async getETF() {
                const mockETF = [
                    { name: 'KODEX 200', code: '069500', price: 35400, change: 0.8 },
                    { name: 'TIGER ë¯¸êµ­S&P500', code: '360750', price: 14200, change: 1.2 },
                    { name: 'KODEX ê³¨ë“œì„ ë¬¼', code: '132030', price: 7850, change: -0.3 },
                    { name: 'TIGER ë‚˜ìŠ¤ë‹¥100', code: '133690', price: 18900, change: 1.8 }
                ];
                
                return mockETF.map(etf => ({
                    ...etf,
                    price: Math.round(etf.price * (1 + (Math.random() - 0.5) * 0.02)),
                    change: Number(((Math.random() - 0.5) * 3).toFixed(2))
                }));
            },

            // ì˜ˆì ê¸ˆ ë°ì´í„°
            async getSavings() {
                return [
                    { name: 'ì •ê¸°ì˜ˆê¸ˆ 12ê°œì›”', code: 'SAVINGS_12M', price: 3.5, change: 0, unit: '%' },
                    { name: 'ì •ê¸°ì ê¸ˆ 24ê°œì›”', code: 'INSTALL_24M', price: 3.8, change: 0, unit: '%' },
                    { name: 'CMA í†µì¥', code: 'CMA', price: 2.1, change: 0, unit: '%' },
                    { name: 'ììœ ì ê¸ˆ', code: 'FREE_SAVINGS', price: 2.8, change: 0, unit: '%' }
                ];
            },

            // ê·€ê¸ˆì† ë°ì´í„°
            async getCommodities() {
                const mockCommodities = [
                    { name: 'ê¸ˆ (1g)', code: 'GOLD', price: 78000, change: 0.5 },
                    { name: 'ì€ (1g)', code: 'SILVER', price: 980, change: -0.3 },
                    { name: 'ë°±ê¸ˆ (1g)', code: 'PLATINUM', price: 42000, change: 1.2 },
                    { name: 'íŒ”ë¼ë“ (1g)', code: 'PALLADIUM', price: 85000, change: -1.8 }
                ];
                
                return mockCommodities.map(commodity => ({
                    ...commodity,
                    price: Math.round(commodity.price * (1 + (Math.random() - 0.5) * 0.03)),
                    change: Number(((Math.random() - 0.5) * 4).toFixed(2))
                }));
            }
        };

        // ì¹´í…Œê³ ë¦¬ ì„ íƒ
        function selectCategory(category) {
            // ì´ì „ í™œì„± ì¹´ë“œ ë¹„í™œì„±í™”
            document.querySelectorAll('.product-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // ìƒˆë¡œìš´ ì¹´ë“œ í™œì„±í™”
            event.target.closest('.product-card').classList.add('active');
            
            currentCategory = category;
            loadProducts(category);
        }

        // ìƒí’ˆ ëª©ë¡ ë¡œë“œ
        async function loadProducts(category) {
            const container = document.getElementById('productContainer');
            const header = document.getElementById('listHeader');
            
            // ë¡œë”© ìƒíƒœ
            container.innerHTML = '<div style="text-align: center; padding: 40px;"><div class="loading"></div></div>';
            
            let products = [];
            let headerText = '';
            
            switch(category) {
                case 'stocks':
                    products = await InvestmentAPI.getStocks();
                    headerText = 'ğŸ“ˆ ì£¼ì‹';
                    break;
                case 'crypto':
                    products = await InvestmentAPI.getCrypto();
                    headerText = 'â‚¿ ì•”í˜¸í™”í';
                    break;
                case 'bonds':
                    products = await InvestmentAPI.getBonds();
                    headerText = 'ğŸ“œ ì±„ê¶Œ';
                    break;
                case 'etf':
                    products = await InvestmentAPI.getETF();
                    headerText = 'ğŸ“Š ETF';
                    break;
                case 'savings':
                    products = await InvestmentAPI.getSavings();
                    headerText = 'ğŸ¦ ì˜ˆì ê¸ˆ';
                    break;
                case 'commodities':
                    products = await InvestmentAPI.getCommodities();
                    headerText = 'ğŸ¥‡ ê·€ê¸ˆì†';
                    break;
            }
            
            header.textContent = headerText;
            container.innerHTML = '';
            
            products.forEach(product => {
                const item = createProductItem(product, category);
                container.appendChild(item);
            });
        }

        // ìƒí’ˆ ì•„ì´í…œ ìƒì„±
        function createProductItem(product, category) {
            const item = document.createElement('div');
            item.className = 'product-item';
            item.onclick = () => openInvestModal(product, category);
            
            const priceClass = product.change >= 0 ? 'positive' : 'negative';
            const changeSymbol = product.change >= 0 ? '+' : '';
            const unit = product.unit || '';
            
            item.innerHTML = `
                <div class="item-info">
                    <div class="item-name">${product.name}</div>
                    <div class="item-code">${product.code}</div>
                </div>
                <div class="item-price">
                    <div class="current-price">
                        ${unit ? product.price + unit : 'â‚©' + product.price.toLocaleString()}
                    </div>
                    <div class="price-change ${priceClass}">
                        ${changeSymbol}${product.change}%
                    </div>
                </div>
            `;
            
            return item;
        }

        // íˆ¬ì ëª¨ë‹¬ ì—´ê¸°
        function openInvestModal(product, category) {
            selectedProduct = { ...product, category };
            
            document.getElementById('modalTitle').textContent = `${product.name} íˆ¬ìí•˜ê¸°`;
            document.getElementById('investAmount').value = '';
            document.getElementById('investQuantity').value = '';
            document.getElementById('expectedTotal').textContent = 'â‚©0';
            
            document.getElementById('investModal').style.display = 'block';
            
            // ì‹¤ì‹œê°„ ê³„ì‚°
            const amountInput = document.getElementById('investAmount');
            const quantityInput = document.getElementById('investQuantity');
            
            [amountInput, quantityInput].forEach(input => {
                input.addEventListener('input', calculateTotal);
            });
        }

        // ì´ íˆ¬ìê¸ˆì•¡ ê³„ì‚°
        function calculateTotal() {
            const amount = parseFloat(document.getElementById('investAmount').value) || 0;
            const quantity = parseFloat(document.getElementById('investQuantity').value) || 0;
            
            let total = 0;
            if (selectedProduct.category === 'savings') {
                total = amount; // ì˜ˆì ê¸ˆì€ ì›ê¸ˆë§Œ
            } else {
                total = selectedProduct.price * quantity;
                if (amount > 0 && quantity === 0) {
                    // ê¸ˆì•¡ìœ¼ë¡œ ìˆ˜ëŸ‰ ê³„ì‚°
                    const calculatedQuantity = Math.floor(amount / selectedProduct.price);
                    document.getElementById('investQuantity').value = calculatedQuantity;
                    total = calculatedQuantity * selectedProduct.price;
                }
            }
            
            document.getElementById('expectedTotal').textContent = 'â‚©' + total.toLocaleString();
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeModal() {
            document.getElementById('investModal').style.display = 'none';
            selectedProduct = null;
        }

        // íˆ¬ì ì‹¤í–‰
        function executeInvestment() {
            const amount = parseFloat(document.getElementById('investAmount').value);
            const quantity = parseFloat(document.getElementById('investQuantity').value);
            
            if (!amount && !quantity) {
                alert('íˆ¬ì ê¸ˆì•¡ ë˜ëŠ” ìˆ˜ëŸ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const balance = parseFloat(localStorage.getItem('balance')) || 10000000;
            let investmentAmount = 0;
            
            if (selectedProduct.category === 'savings') {
                investmentAmount = amount;
                // ì˜ˆì ê¸ˆ ê°€ì…ì‹œ ê°€ê³„ë¶€ì— ìë™ ê¸°ë¡
                addToAccountBook(selectedProduct.name, amount, 'ì˜ˆì ê¸ˆ');
            } else {
                investmentAmount = selectedProduct.price * quantity;
            }
            
            if (investmentAmount > balance) {
                alert('ì”ê³ ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.');
                return;
            }
            
            // ì”ê³  ì°¨ê°
            const newBalance = balance - investmentAmount;
            localStorage.setItem('balance', newBalance);
            
            // í¬íŠ¸í´ë¦¬ì˜¤ì— ì¶”ê°€
            addToPortfolio(selectedProduct, quantity || amount, investmentAmount);
            
            // UI ì—…ë°ì´íŠ¸
            updateBalance();
            updatePortfolioSummary();
            
            alert(`íˆ¬ìê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\níˆ¬ìê¸ˆì•¡: â‚©${investmentAmount.toLocaleString()}`);
            closeModal();
        }

        // í¬íŠ¸í´ë¦¬ì˜¤ì— ì¶”ê°€
        function addToPortfolio(product, quantity, amount) {
            const portfolio = JSON.parse(localStorage.getItem('portfolio')) || [];
            
            const existingIndex = portfolio.findIndex(item => 
                item.code === product.code && item.category === product.category
            );
            
            if (existingIndex >= 0) {
                // ê¸°ì¡´ ë³´ìœ  ìƒí’ˆì— ì¶”ê°€
                portfolio[existingIndex].quantity += quantity;
                portfolio[existingIndex].totalInvested += amount;
                portfolio[existingIndex].avgPrice = portfolio[existingIndex].totalInvested / portfolio[existingIndex].quantity;
            } else {
                // ìƒˆë¡œìš´ ìƒí’ˆ ì¶”ê°€
                portfolio.push({
                    name: product.name,
                    code: product.code,
                    category: product.category,
                    quantity: quantity,
                    avgPrice: product.price,
                    currentPrice: product.price,
                    totalInvested: amount,
                    purchaseDate: new Date().toISOString()
                });
            }
            
            localStorage.setItem('portfolio', JSON.stringify(portfolio));
        }

        // ê°€ê³„ë¶€ì— ì¶”ê°€
        function addToAccountBook(description, amount, category) {
            const transactions = JSON.parse(localStorage.getItem('transactions')) || [];
            
            transactions.push({
                id: Date.now(),
                date: new Date().toISOString().split('T')[0],
                description: description,
                amount: -amount, // ì§€ì¶œ
                category: category,
                type: 'expense'
            });
            
            localStorage.setItem('transactions', JSON.stringify(transactions));
        }

        // ì”ê³  ì—…ë°ì´íŠ¸
        function updateBalance() {
            const balance = parseFloat(localStorage.getItem('balance')) || 10000000;
            document.getElementById('balance').textContent = 'â‚©' + balance.toLocaleString();
        }

        // í¬íŠ¸í´ë¦¬ì˜¤ ìš”ì•½ ì—…ë°ì´íŠ¸
        function updatePortfolioSummary() {
            const portfolio = JSON.parse(localStorage.getItem('portfolio')) || [];
            
            let totalInvested = 0;
            let currentValue = 0;
            
            portfolio.forEach(item => {
                totalInvested += item.totalInvested;
                currentValue += item.quantity * item.currentPrice;
            });
            
            const profitLoss = currentValue - totalInvested;
            const profitRate = totalInvested > 0 ? (profitLoss / totalInvested * 100) : 0;
            
            document.getElementById('totalInvested').textContent = 'â‚©' + totalInvested.toLocaleString();
            document.getElementById('currentValue').textContent = 'â‚©' + currentValue.toLocaleString();
            
            const profitElement = document.getElementById('profitLoss');
            const profitText = `â‚©${Math.abs(profitLoss).toLocaleString()} (${profitRate >= 0 ? '+' : ''}${profitRate.toFixed(2)}%)`;
            profitElement.textContent = profitText;
            profitElement.style.color = profitLoss >= 0 ? '#dc3545' : '#0d6efd';
            
            // í™ˆí˜ì´ì§€ ìì‚° ì •ë³´ë„ ì—…ë°ì´íŠ¸
            const assets = {
                total: currentValue + (parseFloat(localStorage.getItem('balance')) || 10000000),
                returnRate: profitRate
            };
            localStorage.setItem('userAssets', JSON.stringify(assets));
        }

        // ì‹¤ì‹œê°„ ê°€ê²© ì—…ë°ì´íŠ¸ ì‹œì‘
        function startPriceUpdates() {
            if (priceUpdateInterval) {
                clearInterval(priceUpdateInterval);
            }
            
            priceUpdateInterval = setInterval(() => {
                loadProducts(currentCategory);
                updatePortfolioSummary();
            }, 30000); // 30ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
        }

        // í”„ë¡œí•„ë¡œ ì´ë™
        function goToProfile() {
            window.location.href = 'index.html';
        }

        // í”„ë¡œí•„ ì´ë¯¸ì§€ ë¡œë“œ
        function loadProfileImage() {
            const savedImage = localStorage.getItem('profileImage');
            if (savedImage) {
                const headerProfileImg = document.getElementById('headerProfileImg');
                const headerDefaultIcon = document.getElementById('headerDefaultIcon');
                
                if (headerProfileImg && headerDefaultIcon) {
                    headerProfileImg.src = savedImage;
                    headerProfileImg.style.display = 'block';
                    headerDefaultIcon.style.display = 'none';
                }
            }
        }

        // í˜ì´ì§€ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            loadProfileImage();
            updateBalance();
            updatePortfolioSummary();
            loadProducts('stocks');
            startPriceUpdates();
        });

        // í˜ì´ì§€ ì¢…ë£Œì‹œ ì¸í„°ë²Œ ì •ë¦¬
        window.addEventListener('beforeunload', function() {
            if (priceUpdateInterval) {
                clearInterval(priceUpdateInterval);
            }
        });

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
        document.getElementById('investModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>
</body>
</html>